[
  {
    "section": "Find your IP Address",
    "questions": [
      {
        "type": "short-answer",
        "description": [
          "<p>The first stage of any attack is to gather as much information about the target.</p>",
          "<p>Before you can find any details of the webserver, you’ll need to know your own IP address.</p>",
          "<p>An Internet Protocol (IP) address is a unique number assigned to every device on the internet.</p>",
          "<p>It helps websites, apps, and devices know where to send data. Each IP address is a set of four numbers, joined by full stops - for example, 152.174.18.19.</p>",
          "<p>To find your IP address, you can use the 'ifconfig' command in the terminal.</p>"
        ],
        "question": "What is your IP address?",
        "answer_format": "x.x.x.x",
        "hints": [
          "Run the command `ifconfig` in the terminal.",
          "Look for a line starting with `inet` that shows your IP address (not 127.0.0.1)."
        ],
        "saveAsNote": true,
        "noteKey": "IP_ADDRESS",
        "noteLabel": "Machine IP",
        "target_ip_type": "general"
      }
    ]
  },
  {
    "section": "Network Scanning",
    "questions": [
      {
        "type": "short-answer",
        "description": [
          "<p>Now that you’ve found your IP address, you can scan the network to find the IP address of other devices.</p>",
          "<p>You will want to find the webserver IP to get into the system.</p>",
          "<p>To scan the network, a tool called nmap can be used.</p>",
          "<p>Nmap is used to discover hosts and services on a computer network, meaning it should find the webserver holding the scores.</p>",
          "<p>To run nmap, you can use the command <code>nmap -sT [YOUR IP]/24</code> and this will return details of any devices on the network.</p>"
        ],
        "question": "What command do you need to run to find the Webserver?",
        "validation": {
          "predefinedAnswer": "nmap -sT [IP_ADDRESS]/24"
        }
      },
      {
        "type": "short-answer",
        "description": [
          "<p>Now that you have run nmap, you should see a list of devices on the network.</p>",
          "<p>Look for the device with the name ‘webserver’ and note down its IP address.</p>"
        ],
        "question": "What is the IP address for the Webserver?",
        "answer_format": "x.x.x.x",
        "hints": [
          "Run the command `ifconfig` in the terminal.",
          "Look for a line starting with `inet` that shows your IP address (not 127.0.0.1)."
        ],
        "saveAsNote": true,
        "noteKey": "IP_ADDRESS",
        "noteLabel": "Webserver IP",
        "target_ip_type": "webserver"
      }
    ]
  },
  {
    "section": "Finding Hidden Pages",
    "questions": [
      {
        "type": "multiple-choice",
        "description": [
          "<p>Websites often have hidden pages that are not linked anywhere.</p>",
          "<p>These pages might contain useful information or tools – like a way to change the scoreboard!</p>",
          "<p>We can find these pages using a tool called dirb.</p>",
          "<p>This tool guesses possible page names and checks if they exist.</p>",
          "<p>Type the following command into the terminal: <code>dirb http://{WEB_SERVER_IP}</code></p>",
          "<p>Look at the results. Some pages might stand out – one of them could let you modify the scores!</p>"
        ],
        "question": "What hidden pages did dirb find on the webserver?",
        "choices": ["admin", "console", "team", "test"],
        "validation": {
          "predefinedAnswer": ["admin", "console", "team", "test"]
        }
      },
      {
        "type": "short-answer",
        "description": [
          "<p>Now that you have found some pages, you can test them in the browser.</p>",
          "<p>Open a new tab and go to: <code>http://{WEB_SERVER_IP}/{WEBPAGE}</code></p>",
          "<p>Look through all the webpages and see if you can find one that will allow you to reset the team's scores.</p>"
        ],
        "question": "Which page allows you to reset the scoreboard?",
        "validation": {
          "predefinedAnswer": "admin"
        }
      },
      {
        "type": "short-answer",
        "question": "Which page allows you to increase your own score?"
      }
    ]
  },
  {
    "section": "Service Enumeration",
    "questions": [
      {
        "type": "short-answer",
        "description": [
          "<p>You can now increase your own score! However, it could be better to automate this process so the score increases automatically.</p>",
          "<p>We want to rerun nmap to check if there are any other useful services running on the web server.</p>",
          "<p>Use the command: <code>nmap -sV {WEB_SERVER_IP}</code></p>"
        ],
        "question": "What services are running on the web server?"
      }
    ]
  },
  {
    "section": "Exploiting FTP",
    "questions": [
      {
        "type": "short-answer",
        "description": [
          "<p>The service that we are interested in now is FTP (File Transfer Protocol).</p>",
          "<p>This service allows remote file access, which can allow you to find important information such as login details.</p>",
          "<p>To connect to the FTP server, use the command <code>ftp {WEB_SERVER_IP}</code>.</p>",
          "<p>Press continue once you have connected.</p>",
          "<p>One of these files contains a password hash for the ‘student’ account.</p>"
        ],
        "question": "What is the name of the file containing the password hash?"
      },
      {
        "type": "short-answer",
        "question": "What is the password hash?"
      }
    ]
  },
  {
    "section": "Password Cracking",
    "questions": [
      {
        "type": "short-answer",
        "description": [
          "<p>Password hashing is used to transform a plaintext password into a string of characters to make passwords harder to read.</p>",
          "<p>However, weak passwords can still be cracked using tools!</p>",
          "<p>In this challenge, we’ll use Hashcat to get the real password.</p>",
          "<p>- Save the hash into a file: <code>nano hash_file.txt</code></p>",
          "<p>- Paste the hash and save the file</p>",
          "<p>- Run hashcat</p>",
          "<p>Hashcat will compare the hash to a long list of common password hashes. If it finds a match, it will reveal to us the password.</p>"
        ],
        "question": "What is the cracked password?"
      }
    ]
  }
]
